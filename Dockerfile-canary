FROM ansibleplaybookbundle/apb-base:canary
MAINTAINER Ansible Playbook Bundle Community

LABEL "com.redhat.apb.spec"=\
"LS0tCgp2ZXJzaW9uOiAxLjAuMApuYW1lOiBteXNxbC1hcGIKZGVzY3JpcHRpb246ICJTb2Z0d2Fy\
ZSBDb2xsZWN0aW9ucyBNeVNRTCBBUEIiCmJpbmRhYmxlOiB0cnVlCmFzeW5jOiBvcHRpb25hbAp0\
YWdzOgogIC0gZGF0YWJhc2UKICAtIG15c3FsCm1ldGFkYXRhOgogIGRpc3BsYXlOYW1lOiAiTXlT\
UUwgKEFQQikiCiAgbG9uZ0Rlc2NyaXB0aW9uOiAiQW4gQW5zaWJsZSBQbGF5Ym9vayBCdW5kbGUg\
KEFQQikgdGhhdCBkZXBsb3lzIE15U1FMIgogIGNvbnNvbGUub3BlbnNoaWZ0LmlvL2ljb25DbGFz\
czogaWNvbi1teXNxbC1kYXRhYmFzZQogIGRvY3VtZW50YXRpb25Vcmw6ICJodHRwczovL2dpdGh1\
Yi5jb20vc2Nsb3JnL215c3FsLWNvbnRhaW5lci8iCiAgZGVwZW5kZW5jaWVzOgogICAgLSAncmVn\
aXN0cnkuYWNjZXNzLnJlZGhhdC5jb20vcmhzY2wvbXlzcWwtNTYtcmhlbDcnCiAgICAtICdyZWdp\
c3RyeS5hY2Nlc3MucmVkaGF0LmNvbS9yaHNjbC9teXNxbC01Ny1yaGVsNycKICBwcm92aWRlckRp\
c3BsYXlOYW1lOiAiUmVkIEhhdCwgSW5jLiIKcGxhbnM6CiAgLSBuYW1lOiBkZXYKICAgIGRlc2Ny\
aXB0aW9uOiBBIE15U1FMIHNlcnZlciB3aXRoIGVwaGVtZXJhbCBzdG9yYWdlCiAgICBmcmVlOiB0\
cnVlCiAgICBkZWZhdWx0OiB0cnVlCiAgICBtZXRhZGF0YToKICAgICAgZGlzcGxheU5hbWU6IERl\
dmVsb3BtZW50CiAgICAgIGxvbmdEZXNjcmlwdGlvbjoKICAgICAgICBUaGlzIHBsYW4gcHJvdmlk\
ZXMgYSBzaW5nbGUgbm9uLUhBIE15U1FMIHNlcnZlciB3L28gcGVyc2lzdGVudCBzdG9yYWdlCiAg\
ICAgIGNvc3Q6ICQwLjAwCiAgICB1cGRhdGVzX3RvOgogICAgICAtIHByb2QKICAgIHBhcmFtZXRl\
cnM6CiAgICAgIC0gbmFtZTogbXlzcWxfdmVyc2lvbgogICAgICAgIGRlc2NyaXB0aW9uOiBWZXJz\
aW9uIG9mIE15U1FMIHRvIGRlcGxveQogICAgICAgIHR5cGU6IGVudW0KICAgICAgICBlbnVtOiBb\
IjUuNiIsICI1LjciXQogICAgICAgIGRlZmF1bHQ6ICI1LjciCiAgICAgICAgcmVxdWlyZWQ6IHRy\
dWUKICAgICAgICB1cGRhdGFibGU6IHRydWUKICAgICAgLSBuYW1lOiBteXNxbF9kYXRhYmFzZQog\
ICAgICAgIGRlc2NyaXB0aW9uOiBUaGUgbmFtZSBvZiB0aGUgTXlTUUwgZGF0YWJhc2UKICAgICAg\
ICB0eXBlOiBzdHJpbmcKICAgICAgICBkZWZhdWx0OiBkZXZlbAogICAgICAgIHBhdHRlcm46ICJe\
W2EtekEtWjAtOV9dKlthLXpBLVpfXStbYS16QS1aMC05X10qJCIKICAgICAgICByZXF1aXJlZDog\
dHJ1ZQogICAgICAtIG5hbWU6IG15c3FsX3VzZXIKICAgICAgICBkZXNjcmlwdGlvbjogVXNlcm5h\
bWUgdGhhdCB3aWxsIGJlIHVzZWQgdG8gY29ubmVjdCB0byBNeVNRTAogICAgICAgIHR5cGU6IHN0\
cmluZwogICAgICAgIGRlZmF1bHQ6IGRldmVsCiAgICAgICAgcGF0dGVybjogIl5bYS16QS1aMC05\
X10qW2EtekEtWl9dK1thLXpBLVowLTlfXSokIgogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAg\
IC0gbmFtZTogbXlzcWxfcGFzc3dvcmQKICAgICAgICBkZXNjcmlwdGlvbjogUGFzc3dvcmQgdG8g\
Y29ubmVjdCB0byBNeVNRTAogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHJlcXVpcmVkOiB0\
cnVlCiAgICAgICAgZGlzcGxheV90eXBlOiBwYXNzd29yZAogIC0gbmFtZTogcHJvZAogICAgZGVz\
Y3JpcHRpb246IEEgTXlTUUwgc2VydmVyIHdpdGggcGVyc2lzdGVudCBzdG9yYWdlCiAgICBmcmVl\
OiBmYWxzZQogICAgbWV0YWRhdGE6CiAgICAgIGRpc3BsYXlOYW1lOiBQcm9kdWN0aW9uCiAgICAg\
IGxvbmdEZXNjcmlwdGlvbjoKICAgICAgICBUaGlzIHBsYW4gcHJvdmlkZXMgYSBzaW5nbGUgbm9u\
LUhBIE15U1FMIHNlcnZlciB3aXRoIHBlcnNpc3RlbnQgc3RvcmFnZQogICAgICBjb3N0OiAkNS45\
OSBtb250aGx5CiAgICBwYXJhbWV0ZXJzOgogICAgICAtIG5hbWU6IG15c3FsX3ZlcnNpb24KICAg\
ICAgICBkZXNjcmlwdGlvbjogVmVyc2lvbiBvZiBNeVNRTCB0byBkZXBsb3kKICAgICAgICB0eXBl\
OiBlbnVtCiAgICAgICAgZW51bTogWyI1LjYiLCAiNS43Il0KICAgICAgICBkZWZhdWx0OiAiNS43\
IgogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgICAgdXBkYXRhYmxlOiB0cnVlCiAgICAgIC0g\
bmFtZTogbXlzcWxfZGF0YWJhc2UKICAgICAgICBkZXNjcmlwdGlvbjogVGhlIG5hbWUgb2YgdGhl\
IE15U1FMIGRhdGFiYXNlCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgZGVmYXVsdDogZGV2\
ZWwKICAgICAgICBwYXR0ZXJuOiAiXlthLXpBLVowLTlfXSpbYS16QS1aX10rW2EtekEtWjAtOV9d\
KiQiCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgLSBuYW1lOiBteXNxbF91c2VyCiAgICAg\
ICAgZGVzY3JpcHRpb246IFVzZXJuYW1lIHRoYXQgd2lsbCBiZSB1c2VkIHRvIGNvbm5lY3QgdG8g\
TXlTUUwKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICBkZWZhdWx0OiBkZXZlbAogICAgICAg\
IHBhdHRlcm46ICJeW2EtekEtWjAtOV9dKlthLXpBLVpfXStbYS16QS1aMC05X10qJCIKICAgICAg\
ICByZXF1aXJlZDogdHJ1ZQogICAgICAtIG5hbWU6IG15c3FsX3Bhc3N3b3JkCiAgICAgICAgZGVz\
Y3JpcHRpb246IFBhc3N3b3JkIHRvIGNvbm5lY3QgdG8gTXlTUUwKICAgICAgICB0eXBlOiBzdHJp\
bmcKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAgIGRpc3BsYXlfdHlwZTogcGFzc3dvcmQK\
ICAgICAgLSBuYW1lOiB2b2x1bWVfc2l6ZQogICAgICAgIHR5cGU6IGVudW0KICAgICAgICBkZWZh\
dWx0OiAnMUdpJwogICAgICAgIGVudW06IFsnMUdpJywgJzVHaScsICcxMEdpJ10KICAgICAgICB0\
aXRsZTogTXlTUUwgVm9sdW1lIFNpemUKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgdXBkYXRl\
c190bzoKICAgICAgLSBkZXYK"


ADD playbooks /opt/apb/actions

# Add our role into the ansible roles dir
ADD . /opt/ansible/roles/mysql-apb

RUN chmod -R g=u /opt/{ansible,apb}

USER apb
